# FinalCutProjectGenerator

Скрипт для упрощения монтажа видео+презентация на проекторе в FinalCut.

1. Запишите время переключения слайдов при помощи Кейлоггера (https://yadi.sk/d/x2k_Bs-r3GDCer пока только Windows).
2. Экспортируйте презентацию лектора в JPG файлы.
3. Запустите скрипт с указанием файла и папки с презентацией.
4. Вы получите готовый .fcpxml файл.
5. Импортируйте fcpxml файл в FinalCut и вы увидите слайды с презентацией на временной шкале как их переключал лектор.


This is little script, that helps you edit video in the FinalCut with PowerPoint presentation.

1. Record slide switching by KeyLogger (https://yadi.sk/d/x2k_Bs-r3GDCer only Windows).
2. Export PowerPoint/PDF file to JPG files.
3. Run this script with timestamps from keylogger file and folder with JPGs.
4. Profit! You got .fcpxml file!
5. Import fcpxml file to FinalCut and you see timeline with Slides with correct time point.


# Run:
```
python main.py <arguments>

usage: main.py [-h] [-k KEYLOG] [-o OUTPUT] [-s SLIDES] [-w WIDTH] [-t HEIGHT]
               [-m FRAMES] [-e EVENT] [-n NAME] [-f FIRST_SEC] [-l LAST_SEC]
               [-g GAP_SEC] [-a ANIMATION] [-q SETTINGS]

optional arguments:
  -h, --help            show this help message and exit
  -k KEYLOG, --keylog KEYLOG
                        TXT file with switch slides timestamps (generated by
                        PresentationLogger.exe)
  -o OUTPUT, --output OUTPUT
                        Output FCPXML 1.4 file path
  -s SLIDES, --slides SLIDES
                        Folder with presentation JPG files
  -w WIDTH, --width WIDTH
                        FC project width, pixels
  -t HEIGHT, --height HEIGHT
                        FC project height, pixels
  -m FRAMES, --frames FRAMES
                        Frames per second in FC project
  -e EVENT, --event EVENT
                        FC event name
  -n NAME, --name NAME  FC project name
  -f FIRST_SEC, --first_sec FIRST_SEC
                        First slide show length, seconds (float)
  -l LAST_SEC, --last_sec LAST_SEC
                        Last slide show length, seconds (float)
  -g GAP_SEC, --gap_sec GAP_SEC
                        Black screen before slides, seconds (float)
  -a ANIMATION, --animation ANIMATION
                        Animation on slides, format 'S1:N1;S2:N2;..' Sx-slide
                        num, Nx-clicks
  -q SETTINGS, --settings SETTINGS
                        You can tune your slides transformation. Example: tran
                        sform.scale=47;transform.position.x=55;transform.posit
                        ion.y=21.1759
```

# Example:

python main.py -k "./2017-04-26 20-05-12.482.txt" -o "./a.fcpxml" -s "/home/username/Movies/pres" -w 1920 -t 1080 -m 25 -e "pres" -n "pres" -f 10 -l 10 -g 10

# TODO:
- Автоматическое определение временных меток: если кейлоггер хардварный без часов.
- Добавление слайдов к уже существующему проекту